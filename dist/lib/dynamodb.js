import * as cdk from 'aws-cdk-lib';
import { makeId, makeName } from './naming';
export const createDynamoDbTable = (name, props) => {
    const table = new cdk.aws_dynamodb.Table(props.stack, makeId(name), {
        tableName: makeName(name),
        partitionKey: props.partitionKey,
        sortKey: props.sortKey,
        billingMode: cdk.aws_dynamodb.BillingMode.PAY_PER_REQUEST,
        removalPolicy: cdk.RemovalPolicy.DESTROY,
    });
    if (props.secondaryIndexes) {
        props.secondaryIndexes.forEach((secondaryIndex) => {
            table.addGlobalSecondaryIndex({
                indexName: secondaryIndex.indexName,
                partitionKey: secondaryIndex.partitionKey,
                projectionType: cdk.aws_dynamodb.ProjectionType.ALL,
            });
        });
    }
    return table;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHluYW1vZGIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9saWIvZHluYW1vZGIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLEdBQUcsTUFBTSxhQUFhLENBQUE7QUFDbEMsT0FBTyxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsTUFBTSxVQUFVLENBQUE7QUFFM0MsTUFBTSxDQUFDLE1BQU0sbUJBQW1CLEdBQUcsQ0FDakMsSUFBWSxFQUNaLEtBUUMsRUFDRCxFQUFFO0lBQ0YsTUFBTSxLQUFLLEdBQUcsSUFBSSxHQUFHLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUNsRSxTQUFTLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQztRQUN6QixZQUFZLEVBQUUsS0FBSyxDQUFDLFlBQVk7UUFDaEMsT0FBTyxFQUFFLEtBQUssQ0FBQyxPQUFPO1FBQ3RCLFdBQVcsRUFBRSxHQUFHLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxlQUFlO1FBQ3pELGFBQWEsRUFBRSxHQUFHLENBQUMsYUFBYSxDQUFDLE9BQU87S0FDekMsQ0FBQyxDQUFBO0lBQ0YsSUFBSSxLQUFLLENBQUMsZ0JBQWdCLEVBQUU7UUFDMUIsS0FBSyxDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDLGNBQWMsRUFBRSxFQUFFO1lBQ2hELEtBQUssQ0FBQyx1QkFBdUIsQ0FBQztnQkFDNUIsU0FBUyxFQUFFLGNBQWMsQ0FBQyxTQUFTO2dCQUNuQyxZQUFZLEVBQUUsY0FBYyxDQUFDLFlBQVk7Z0JBQ3pDLGNBQWMsRUFBRSxHQUFHLENBQUMsWUFBWSxDQUFDLGNBQWMsQ0FBQyxHQUFHO2FBQ3BELENBQUMsQ0FBQTtRQUNKLENBQUMsQ0FBQyxDQUFBO0tBRUg7SUFDRCxPQUFPLEtBQUssQ0FBQTtBQUNkLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNkayBmcm9tICdhd3MtY2RrLWxpYidcbmltcG9ydCB7IG1ha2VJZCwgbWFrZU5hbWUgfSBmcm9tICcuL25hbWluZydcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZUR5bmFtb0RiVGFibGUgPSAoXG4gIG5hbWU6IHN0cmluZyxcbiAgcHJvcHM6IHtcbiAgICBzdGFjazogY2RrLlN0YWNrXG4gICAgcGFydGl0aW9uS2V5OiB7IG5hbWU6IHN0cmluZzsgdHlwZTogY2RrLmF3c19keW5hbW9kYi5BdHRyaWJ1dGVUeXBlIH1cbiAgICBzb3J0S2V5PzogeyBuYW1lOiBzdHJpbmc7IHR5cGU6IGNkay5hd3NfZHluYW1vZGIuQXR0cmlidXRlVHlwZSB9XG4gICAgc2Vjb25kYXJ5SW5kZXhlcz86IHtcbiAgICAgIGluZGV4TmFtZTogc3RyaW5nXG4gICAgICBwYXJ0aXRpb25LZXk6IHsgbmFtZTogc3RyaW5nOyB0eXBlOiBjZGsuYXdzX2R5bmFtb2RiLkF0dHJpYnV0ZVR5cGUgfVxuICAgIH1bXVxuICB9XG4pID0+IHtcbiAgY29uc3QgdGFibGUgPSBuZXcgY2RrLmF3c19keW5hbW9kYi5UYWJsZShwcm9wcy5zdGFjaywgbWFrZUlkKG5hbWUpLCB7XG4gICAgdGFibGVOYW1lOiBtYWtlTmFtZShuYW1lKSxcbiAgICBwYXJ0aXRpb25LZXk6IHByb3BzLnBhcnRpdGlvbktleSxcbiAgICBzb3J0S2V5OiBwcm9wcy5zb3J0S2V5LFxuICAgIGJpbGxpbmdNb2RlOiBjZGsuYXdzX2R5bmFtb2RiLkJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcbiAgICByZW1vdmFsUG9saWN5OiBjZGsuUmVtb3ZhbFBvbGljeS5ERVNUUk9ZLFxuICB9KVxuICBpZiAocHJvcHMuc2Vjb25kYXJ5SW5kZXhlcykge1xuICAgIHByb3BzLnNlY29uZGFyeUluZGV4ZXMuZm9yRWFjaCgoc2Vjb25kYXJ5SW5kZXgpID0+IHtcbiAgICAgIHRhYmxlLmFkZEdsb2JhbFNlY29uZGFyeUluZGV4KHtcbiAgICAgICAgaW5kZXhOYW1lOiBzZWNvbmRhcnlJbmRleC5pbmRleE5hbWUsXG4gICAgICAgIHBhcnRpdGlvbktleTogc2Vjb25kYXJ5SW5kZXgucGFydGl0aW9uS2V5LFxuICAgICAgICBwcm9qZWN0aW9uVHlwZTogY2RrLmF3c19keW5hbW9kYi5Qcm9qZWN0aW9uVHlwZS5BTEwsXG4gICAgICB9KVxuICAgIH0pXG4gICAgXG4gIH1cbiAgcmV0dXJuIHRhYmxlXG59XG4iXX0=